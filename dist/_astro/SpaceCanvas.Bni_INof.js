import{j as g}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.RH_Wq4ov.js";function F({id:i="webgl-canvas",pollMs:f=500,includeSearch:l=!1,includeHash:p=!1}){const d=s.useRef(!1),m=s.useRef(""),c=s.useRef(null);return s.useEffect(()=>{let w=!0;if(d.current)return;d.current=!0;let t,a,n,r;return(async()=>{if(!w)return;window.SpaceManager.init({canvasId:i});const v=()=>{let o=location.pathname;return l&&(o+=location.search),p&&(o+=location.hash),o.replace(/\/+/,"/")},e=(o="")=>{const u=v();if(u!==m.current)try{window.SpaceManager.loadForPath(u),m.current=u}catch(h){console.error("[SpaceCanvas] loadForPath failed",h)}};queueMicrotask(()=>e("microtask")),requestAnimationFrame(()=>e("raf")),t=()=>requestAnimationFrame(()=>{e("after-swap")}),a=()=>requestAnimationFrame(()=>{e("page-load")}),n=()=>requestAnimationFrame(()=>{e("popstate")}),r=()=>requestAnimationFrame(()=>{e("hashchange")}),document.addEventListener("astro:after-swap",t),document.addEventListener("astro:page-load",a),window.addEventListener("popstate",n),window.addEventListener("hashchange",r),c.current=window.setInterval(()=>e("poll"),f)})(),()=>{w=!1,t&&document.removeEventListener("astro:after-swap",t),a&&document.removeEventListener("astro:page-load",a),n&&window.removeEventListener("popstate",n),r&&window.removeEventListener("hashchange",r),c.current!==null&&window.clearInterval(c.current)}},[i,p,l,f]),g.jsx("canvas",{id:i})}export{F as default};
